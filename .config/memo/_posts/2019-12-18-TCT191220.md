# TCT191220


　全部V9ってかいてあるけどV9.1だよね？


No	項目	確認事項
1	MQRELINK	"V8とV9で提供のMQ RELINKモジュールが大幅に変更となっています。V9提供分を使用してRELINKを行いますが注意点などありますか？
別紙「MQRELINKモジュール」参照"

フォールバック時に動くのかどうかはわからない

とりあえずMQのマニュアル上では注意はされてないから大丈夫だとおもうけど・・・






2	CSQ4INSG	V9から新機能REST API応答キューのQLOCAL定義「SYSTEM.REST.REPLY.QUEUE」が追加されていますが新機能を使用する予定がない場合は未定義でも影響は無いでしょうか?

多分大丈夫だけど、SYSTEMQなので作っておいたほうがいい
使われないし





3	フォールバックについて	"V8へのフォールバックは、PP.VOL内「SYS1.MQMM001～」のシステムデータセットのみをバックアップからリストアして対応予定です。
ページ・セット(PSIDxx)、ブート・ストラップ(BSDSxx)、アクティブ・ログ(LOGCOPY1～3)などは、そのまま何もせずにフォールバック後も利用する想定ですが影響などありますか？

問題なし


※フォールバック用PTF(APAR:PI95928)は事前に適用済み。"
4	対外接続テスト	対外接続テストは対MQバージョンを考慮し相手先を選定して接続疎通テストを行うことを想定しています。相手先の選定観点やテストを行う上での考慮事項などあればご教授下さい。

特になし



5	パフォーマンス	"前回OMRON様では、MQ VerUp(V6→V8)の際にパフォーマンスが悪化した事象がありました。
今回V8からV9へ移行するにあたり、他社様などで影響が発生したなど事例があればご教授下さい。"



6	その他	懸念点や考慮事項などあればご教授下さい

全体的に移行後のヴァージョンがV９となっている場所が散見されます。正しくはV9.1.0とのことですので、修正してください。




---
検討事項	お世話になります。

	現在担当のお客様で以下のソフトウェア・バージョンアップ作業を実施しております。
	　　　・MQ(V8.0 => V9.1)

	バージョンアップ環境はz/VM上のテスト環境（下記LPAR3）に構築し、テストを実施予定。
	環境構築作業における疑問点と移行方法について、TCTで質問させて頂きたいと考えております。
	以下に検討内容の概要を記載いたします。詳細については、質問票を後日添付するようにいたします。

	【システム環境概要】
	　　・H/W　　
	　　　　z14(3906-M01)
	　　　　　　LPAR1（本番環境（通称：#B号機））　　　　CPU 100MIPS、メモリ 8GB
	　　　　　　LPAR2（開発環境（通称：#C号機））　　　　CPU 40MIPS、メモリ 8GB
	　　　　　　LPAR3（テスト環境（z/VM））　　　　　　　　CPU 50MIPS、メモリ 8GB
	　　　　　　　　- ゲストOS1（擬似本番環境（通称：VM#B号機））　　メモリ 3GB
	　　　　　　　　- ゲストOS2（擬似開発環境（通称：VM#C号機））　　メモリ 3GB
	　　　　　　　　- ゲストOS3（ドライバー環境（通称：#D号機））　　　メモリ 2GB　

	　　　　　　　　※ゲストOS間でCPUは50MIPSを共用

	　　・S/W
	　　　　バージョンアップ対象SW：　　　MQ V8.0 => V9.1LTS
　　　　バージョンアップ対象外SW：　　z/OS V2.3, IMS(DBのみ) V15.1, DB2 V11.1, CICS V5.3, TWS V9.3, Netview V6.2.1など


	【バージョンアップ方針】
	　　－ SOソリューションである「GSD Platform Services」にて配布されるMQ V9.1をVM環境下のドライバー環境(#D号機)に初期導入する。

	　　－ VM環境下の#D号機のターゲットD/Sをコピーし、擬似本番・開発環境のVM#B、VM#C号機のターゲットD/Sを作成する。キューやチャネルなどのMQ資源はV8.0環境から引き継ぐ。
	　　　　その後、お客様独自カスタマイズ、および非互換対応をVM#B、VM#C号機に適用する。

	　　－ 新機能は基本的に使用しないストレートコンバージョン方式で対応し、既存機能が問題なく利用できる様に構築する。

	　　－ VM#B、VM#C号機で構築したMQ環境および非互換対応により修正した関連リソースは、テスト検証後、新・本番環境（#B号機）、新開発環境（#C号機）として使用する。


	【検討内容（概要）】　　※詳細は期日までに添付資料へ記載させて頂きます。
	　　①MQ導入・カスタマイズについて
	　　　　　- V8.0 => V9.1非互換に関する確認

	　　②移行作業について
	　　　　　- 作成済み移行手順に沿って確認



	どうぞよろしくお願いいたします。

---
背景　目的

MQVupの作業中
来年2月末に本番いこう
V8→V9.1.0LTS

移行方法、手順、テストについて聞きたい

ドライバー環境は移行済み

ZOSはV2.3

GSD ドライバー環境へ導入して、そこからコピー


新機能使わない


本番環境はクラスター環境がある

ZのQMGRと分散が1:1でクラスターを組んでる*2

クライアント接続はない

クラスタとP2Pでの接続がある


サーバーがわのMQの接続はV6~V9まで
OSもいろいろ


1	MQRELINK	"V8とV9で提供のMQ RELINKモジュールが大幅に変更となっています。V9提供分を使用してRELINKを行いますが注意点などありますか？
別紙「MQRELINKモジュール」参照"

フォールバック時に動くのかどうかはわからない

とりあえずMQのマニュアル上では注意はされてないから大丈夫だとおもうけど・・・

MQ提供じゃないよね
GSDで提供されたものですか？
そう

特にガイドもないし、PMRも上がっていないので、問題ないと思う



2	CSQ4INSG	V9から新機能REST API応答キューのQLOCAL定義「SYSTEM.REST.REPLY.QUEUE」が追加されていますが新機能を使用する予定がない場合は未定義でも影響は無いでしょうか?

過去のMQのversionでもSYSTEMQを探す動きがあったことがある
MQの製品推奨としては、SYSTEMQなので作っておいたほうがよい

他のお客様でもSYSTEMQつくる？
追加していただくように案内してる


- 非互換
V8 - V9.1で非互換ある？

ちょうど、他のお客様でも移行することおおい

Client接続の場合はPTFの適応状況に応じてあるけど、ここにはないから大丈夫


資源移行で注意することある？






3	フォールバックについて	"V8へのフォールバックは、PP.VOL内「SYS1.MQMM001～」のシステムデータセットのみをバックアップからリストアして対応予定です。
ページ・セット(PSIDxx)、ブート・ストラップ(BSDSxx)、アクティブ・ログ(LOGCOPY1～3)などは、そのまま何もせずにフォールバック後も利用する想定ですが影響などありますか？

フォールバックPTFが当たっていれば大丈夫
問題なし



4	対外接続テスト	対外接続テストは対MQバージョンを考慮し相手先を選定して接続疎通テストを行うことを想定しています。相手先の選定観点やテストを行う上での考慮事項などあればご教授下さい。

選定の観点としては、すべてのバージョンでやってほしい
優先順位としては古いバージョンとの接続

古いバージョンで問題があるとPTFとかfixpackがでないから

古いバージョンと接続で問題があったことある？
ない
















5	パフォーマンス	"前回OMRON様では、MQ VerUp(V6→V8)の際にパフォーマンスが悪化した事象がありました。
今回V8からV9へ移行するにあたり、他社様などで影響が発生したなど事例があればご教授下さい。"

6-8はパフォーマンス悪化
バッファープールのサイズとvolの配置が悪かった(logとpageset)

パフォーマンスの事例ある？

こちらで認識している限りではない


V8-V9.1が実績数どんなもん？

今月末で数件あるくらい



---
移行作業等


資源引き継ぎだからクラスタ情報とかシーケンすナンバーはケアしなくていい


テスト手順はだいじょうぶか
一通り網羅されていると思う



ZPRM CSQ6SYSP
LOGLOAD
昔のデフォルト値

メッセージはnonper

logにどれくらい書いたらチェックポイントをとるか
低いとcheckpointを頻繁にとる

nonperばっかならlog書かないからどうでもいいかも

きになるならチェックポイントの取られ方をMP1Bでみてくれ

レポート書くまでに障害とかあったら追加


